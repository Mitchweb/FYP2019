"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(e,s){for(var a=0;a<s.length;a++){var t=s[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,s,a){return s&&t(e.prototype,s),a&&t(e,a),e}}(),Validator=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"validateTextInput",value:function(e){document.getElementById(e.getAttribute("name")+"_group").classList.add("was-validated");var s=e.value;0!=s.trim().length?140<s.length?e.setCustomValidity("Input cannot exceed 140 characters."):e.setCustomValidity(""):e.setCustomValidity("Input cannot be empty.")}},{key:"validateTextareaInput",value:function(e){document.getElementById(e.getAttribute("name")+"_group").classList.add("was-validated");var s=e.value;0!=s.trim().length?500<s.length?e.setCustomValidity("Input cannot exceed 500 characters."):e.setCustomValidity(""):e.setCustomValidity("Input cannot be empty.")}},{key:"validateFileInput",value:function(e){document.getElementById(e.getAttribute("name")+"_group").classList.add("was-validated");var s=e.files;0<s.length&&2097152<s[0].size?e.setCustomValidity("File size must be less than 2 MB."):e.setCustomValidity("")}},{key:"validateCheckbox",value:function(e){document.getElementById(e.getAttribute("name")+"_group").classList.add("was-validated"),e.checked?e.setCustomValidity(""):e.setCustomValidity("You must agree to this statement before form submission.")}}]),e}();jQuery(document).ready(function(t){function i(e,s){t("#quiz__progress-bar__"+(e-1)).removeClass("current").addClass("complete"),t("#quiz__progress-bar__"+e).removeClass("incomplete").addClass("current"),t("#quiz__progress-counter").text(e),t("#quiz__question").text(s.question_title),t("#quiz__answers__1").text(s.answer_1),t("#quiz__answers__1").data("id",s.answer_1_id),t("#quiz__answers__2").text(s.answer_2),t("#quiz__answers__2").data("id",s.answer_2_id),null!=s.answer_3?(t("#quiz__answers__3").parent().removeClass("is-removed"),t("#quiz__answers__3").text(s.answer_3),t("#quiz__answers__3").data("id",s.answer_3_id)):t("#quiz__answers__3").parent().addClass("is-removed"),_=s.quiz_tracker}function s(e){var s={},a={action:"get_question_contents",quiz_tracker:_};t.post(quiz_ajax_handler.ajax_url,a,function(e){s=JSON.parse(e)}),n(),setTimeout(function(){r(),setTimeout(function(){for(;t.isEmptyObject(s););i(e,s),t("#quiz__progress-text").removeClass("is-hidden").addClass("is-fading-in"),t("#quiz__question-container").removeClass("is-hidden").addClass("is-fading-in"),t("#quiz__answers").removeClass("is-hidden").addClass("is-fading-in"),setTimeout(function(){t("#quiz__progress-text").removeClass("is-fading-in").addClass("is-visible"),t("#quiz__question-container").removeClass("is-fading-in").addClass("is-visible"),t("#quiz__answers").removeClass("is-fading-in").addClass("is-visible")},600)},100)},300)}function r(){t("#quiz__progress-text").removeClass("is-fading-out").addClass("is-hidden"),t("#quiz__question-container").removeClass("is-fading-out").addClass("is-hidden"),t("#quiz__answers").removeClass("is-fading-out").addClass("is-hidden")}function n(){t("#quiz__progress-text").removeClass("is-visible").addClass("is-fading-out"),t("#quiz__question-container").removeClass("is-visible").addClass("is-fading-out"),t("#quiz__answers").removeClass("is-visible").addClass("is-fading-out")}function a(e){var s=t("#register__next-screen__"+e);switch(e){case 1:t("#register_organisation_name").is(":valid")&&t("#register_organisation_description").is(":valid")?o(s):d(s);break;case 2:t("#register_organisation_contact_picture").is(":valid")&&t("#register_organisation_contact_name").is(":valid")&&t("#register_organisation_contact_email_address").is(":valid")?o(s):d(s);break;case 3:t("#register_organisation_address_line_1").is(":valid")&&t("#register_organisation_address_town_city").is(":valid")&&t("#register_organisation_address_postcode").is(":valid")?o(s):d(s);break;default:console.error("Unexpected buttonNumber!")}}function o(e){e.removeClass("disabled"),e.removeAttr("aria-disabled"),e.removeAttr("tabindex")}function d(e){e.addClass("disabled"),e.attr("aria-disabld","true"),e.attr("tabindex",-1)}function e(e){t("#register__screen__"+(e+1)).removeClass("is-removed"),t("#register__progress-text").removeClass("is-visible").addClass("is-fading-out"),t("#register__screen__"+e).removeClass("is-visible").addClass("is-fading-out"),setTimeout(function(){t("#register__progress-text").removeClass("is-fading-out").addClass("is-hidden"),t("#register__screen__"+e).removeClass("is-fading-out").addClass("is-hidden is-removed"),setTimeout(function(){!function(e){var s;switch(e){case 1:s="Organisation Details";break;case 2:s="Contact Details";break;case 3:s="Organisation Address";break;case 4:s="Submit Registration";break;default:console.error("Unexpected buttonNumber!")}t("#register__progress-bar__"+(e-1)).removeClass("current").addClass("complete"),t("#register__progress-bar__"+e).removeClass("incomplete").addClass("current"),t("#register__progress-counter").text(e),t("#register__progress-description").text(s)}(e+1),t("#register__progress-text").removeClass("is-hidden").addClass("is-fading-in"),t("#register__screen__"+(e+1)).removeClass("is-hidden").addClass("is-fading-in"),setTimeout(function(){t("#register__progress-text").removeClass("is-fading-in").addClass("is-visible"),t("#register__screen__"+(e+1)).removeClass("is-fading-in").addClass("is-visible")},600)},300)},300)}if(window.location.href.includes("/quiz")){var _={questions:[],answers:[]},l=1;u=l,c={action:"get_question_contents",quiz_tracker:_},t.post(quiz_ajax_handler.ajax_url,c,function(e){var s=JSON.parse(e);i(u,s),t("#quiz__splash-screen").addClass("is-hidden"),setTimeout(function(){t("#quiz__loader").removeClass("is-animated")},1e3)}),t(document).on("click",".quiz__answer",function(){if(_.answers.push(t(this).find("a").data("id")),10<=l)return e={action:"get_quiz_results",answers:_.answers},void t.post(quiz_ajax_handler.ajax_url,e,function(e){var s=JSON.parse(e);t("#quiz__results-screen__picture").attr("style","background-image: url('"+s.organisation_contact_picture+"');"),t("#quiz__results-screen__name").text(s.organisation_contact_name+" at "+s.organisation_name),t("#quiz__results-screen__email").attr("href","mailto:"+s.organisation_contact_email_address),t("#quiz__results-screen__email").text(s.organisation_contact_email_address),n(),setTimeout(function(){r(),t("#quiz__results-screen").addClass("is-visible")},300)});var e;s(++l)})}var u,c;if(window.location.href.includes("/register")){t(document).on("click","#register__next-screen__1",function(){e(1)}),t(document).on("click","#register__next-screen__2",function(){e(2)}),t(document).on("click","#register__next-screen__3",function(){e(3)}),t("#register_organisation_name").change(function(){Validator.validateTextInput(t(this)[0]),a(1)}),t("#register_organisation_description").change(function(){Validator.validateTextareaInput(t(this)[0]),a(1)}),t("#register_organisation_contact_picture").change(function(){Validator.validateFileInput(t(this)[0]),a(2);var e=t(this)[0].value;t("#register_organisation_contact_picture_label").text(e.substr(e.lastIndexOf("\\")+1))}),t("#register_organisation_contact_name").change(function(){Validator.validateTextInput(t(this)[0]),a(2)}),t("#register_organisation_contact_email_address").change(function(){Validator.validateTextInput(t(this)[0]),a(2)});var g=t("#register_organisation_address_line_1");g.change(function(){Validator.validateTextInput(t(this)[0]),a(3)});var m=t("#register_organisation_address_town_city");m.change(function(){Validator.validateTextInput(t(this)[0]),a(3)});var v=t("#register_organisation_address_postcode");v.change(function(){Validator.validateTextInput(t(this)[0]),a(3)}),t(document).on("change","#register_organisation_address_lookup_dropdown",function(){g.change(),m.change(),v.change()}),t("#register_organisation_permission").change(function(){Validator.validateCheckbox(t(this)[0])}),t("#register_organisation_terms").change(function(){Validator.validateCheckbox(t(this)[0])}),t("#register_organisation_address_lookup_group").setupPostcodeLookup({api_key:"ak_jt4k0klzUSaV8mS48EnpuRo07CaNh",output_fields:{line_1:"#register_organisation_address_line_1",line_2:"#register_organisation_address_line_2",line_3:"#register_organisation_address_line_3",post_town:"#register_organisation_address_town_city",postcode:"#register_organisation_address_postcode"},input:"#register_organisation_address_lookup",button:"#register_organisation_address_lookup_button",dropdown:"#register_organisation_address_lookup_dropdown",dropdown_id:"register_organisation_address_lookup_dropdown",dropdown_class:"form-control",dropdown_select_message:"Select address",error_message_invalid_postcode:"Invalid postcode.",error_message_not_found:"Postcode not found. Please manually enter the address.",error_message_address_not_found:"Address not found. Please manually enter the address.",error_message_default:"Error. Please manually enter the address.",onSearchCompleted:function(e){2e3===e.code&&t("#register_dummy_dropdown").addClass("is-removed")}});var p=document.getElementById("register_registration_form");p.addEventListener("submit",function(e){if(e.preventDefault(),e.stopPropagation(),!1===p.checkValidity())t("#register_organisation_name_group").addClass("was-validated"),t("#register_organisation_description_group").addClass("was-validated"),t("#register_organisation_contact_name_group").addClass("was-validated"),t("#register_organisation_contact_email_address_group").addClass("was-validated"),t("#register_organisation_address_line_1_group").addClass("was-validated"),t("#register_organisation_address_town_city_group").addClass("was-validated"),t("#register_organisation_address_postcode_group").addClass("was-validated"),t("#register_organisation_permission_group").addClass("was-validated"),t("#register_organisation_terms_group").addClass("was-validated");else{var s=new FormData(t("#register_registration_form")[0]);t.ajax({url:quiz_ajax_handler.ajax_url,type:"POST",data:s,cache:!1,contentType:!1,processData:!1}).done(function(e){0==JSON.parse(e)&&t("#register__results-screen__message").text("There was error in the form. Please try again."),t("#register__progress-text").removeClass("is-visible").addClass("is-fading-out"),t("#register__screen__4").removeClass("is-visible").addClass("is-fading-out"),setTimeout(function(){t("#register__progress-text").removeClass("is-fading-out").addClass("is-hidden is-removed"),t("#register__screen__4").removeClass("is-fading-out").addClass("is-hidden is-removed"),t("#register__results-screen").addClass("is-visible")},300)})}},!1)}});